/*
  Xotic750
 @license {@link <http://www.gnu.org/licenses/gpl-3.0.html> GPL-3.0+}
 @module reiterate
*/
'use strict';(function(root,factory){if(typeof define==="function"&&define.amd)define([],factory);else if(typeof module==="object"&&module.exports)module.exports=factory();else{if(root.hasOwnProperty("reiterate"))throw new Error('Unable to define "reiterate"');Object.defineProperty(root,"reiterate",{enumerable:false,writable:true,configurable:true,value:factory()})}})(this,function(){var $={STRINGTAG:{ARRAY:Object.prototype.toString.call(Array.prototype),MAP:Object.prototype.toString.call(Map.prototype),
SET:Object.prototype.toString.call(Set.prototype),STRING:Object.prototype.toString.call(String.prototype),NUMBER:Object.prototype.toString.call(Number.prototype)},TYPE:{FUNCTION:typeof Function,UNDEFINED:typeof undefined},METHODDESCRIPTOR:{enumerable:false,writable:true,configurable:false,value:undefined},VARIABLEDESCRIPTOR:{enumerable:false,writable:true,configurable:false,value:undefined},SYMBOL:{ENTRIES:Symbol.for("entries"),KEYS:Symbol.for("keys"),VALUES:Symbol.for("values"),STARTED:Symbol.for("started"),
REVERSED:Symbol.for("reversed"),OWN:Symbol.for("own"),FROM:Symbol.for("from"),TO:Symbol.for("to"),BY:Symbol.for("by")}},_={hasOwn:Function.call.bind(Object.prototype.hasOwnProperty),toStringTag:Function.call.bind(Object.prototype.toString),Object:Object,setProperty:function(object,property,descriptor){Object.defineProperty(object,property,descriptor)},setMethod:function(object,property,method){if(_.hasOwn(object,property))throw new Error("property already exists on object");$.METHODDESCRIPTOR.value=
method;_.setProperty(object,property,$.METHODDESCRIPTOR);return method},setVariable:function(object,property,value){$.VARIABLEDESCRIPTOR.value=value;_.setProperty(object,property,$.VARIABLEDESCRIPTOR);return value},isNil:function(subject){return subject==null},toInteger:function(subject){var number=+subject,val=0;if(!Number.isNaN(number))if(!number||!Number.isFinite(number))val=number;else val=Math.sign(number)*Math.floor(Math.abs(number));return val},isNumber:function(subject){return _.toStringTag(subject)===
$.STRINGTAG.NUMBER},clamp:function(number,min,max){if(!_.isNumber(number)||!_.isNumber(min)||!_.isNumber(max))throw new TypeError("argument is not of type number");return Math.min(Math.max(number,min),max)},toSafeInteger:function(subject){return _.clamp(_.toInteger(subject),Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER)},isUndefined:function(subject){return typeof subject===$.TYPE.UNDEFINED},isFunction:function(subject){return typeof subject===$.TYPE.FUNCTION},isString:function(subject){return _.toStringTag(subject)===
$.STRINGTAG.STRING},isLength:function(subject){return _.toSafeInteger(subject)===subject&&subject>=0},isArrayLike:function(subject){return!_.isNil(subject)&&!_.isFunction(subject)&&_.isLength(subject.length)},isArray:function(subject,relaxed){var isA;if(relaxed)isA=_.isArrayLike(subject)&&!_.isString(subject);else isA=Array.isArray(subject);return isA},lastIndex:function(subject){return _.isArrayLike(subject)&&_.toSafeInteger(subject.length-1)||0},isObject:function(subject){return _.Object(subject)===
subject},isSurrogatePair:function(char1,char2){var result=false,code1,code2;if(char1&&char2&&_.isString(char1)&&_.isString(char2)){code1=char1.charCodeAt();if(code1>=55296&&code1<=56319){code2=char2.charCodeAt();if(code2>=56320&&code2<=57343)result=true}}return result},mustBeFunction:function(subject){if(!_.isFunction(subject))throw new TypeError("argument must be a function");return subject},mustBeFunctionIfDefined:function(subject,name){if(!_.isUndefined(subject)&&!_.isFunction(subject))throw new TypeError("If not undefined, "+
name+" must be a function");return subject},clampToSafeIntegerRange:function(subject){var num=+subject,val=0;if(!Number.isNaN(num))val=_.clamp(num,Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER);return val},isCircular:function(thisArg,stack,value){if(stack.has(thisArg)||stack.has(value))throw new TypeError("circular object");return false}};function toArray(mapFn,thisArg){var result,item;_.mustBeFunctionIfDefined(mapFn,"mapFn");for(item of this){if(!result)result=[];result.push(mapFn?mapFn.call(thisArg,
this,item):item)}return result}function*uniqueGenerator(){var seen,item;for(item of this){if(!seen)seen=new Set;if(!seen.has(item)){seen.add(item,true);yield item}}}function*flattenGenerator(relaxed){var stack,object,value,tail;for(object of this){if(_.isArray(object,relaxed))stack=(new Map).set(object,{index:0,prev:null});else yield object;while(stack&&stack.size){tail=stack.get(object);if(tail.index>=object.length){stack.delete(object);object=tail.prev}else{value=object[tail.index];if(_.isArray(value,
relaxed)){_.isCircular(this,stack,value);stack.set(value,{index:0,prev:object});object=value}else yield value;tail.index+=1}}}}function getYieldValue(opts,object,key){var result,value;if(opts.keys)result=key;else{value=object[key];if(opts.values)result=value;else result=[key,value]}return result}function*mapGenerator(callback,thisArg){_.mustBeFunction(callback);for(var element of this)yield callback.call(thisArg,element,this)}function*filterGenerator(callback,thisArg){_.mustBeFunction(callback);for(var element of this)if(callback.call(thisArg,
element,this))yield element}function then(generator){var iterator;if(!_.isFunction(generator)){if(!_.isUndefined(generator))throw new TypeError("If not undefined, generator must be a function");iterator=this}else{iterator=generator(this);_.setMethod(iterator,"filter",filterGenerator);_.setMethod(iterator,"map",mapGenerator);_.setMethod(iterator,"unique",uniqueGenerator);_.setMethod(iterator,"iterate",iterateGenerator);_.setMethod(iterator,"enumerate",EnumerateGenerator);_.setMethod(iterator,"then",
then);_.setMethod(iterator,"toArray",toArray);_.setMethod(iterator,"stringify",stringify);_.setMethod(iterator,"flatten",flattenGenerator)}return iterator}function*countReverseGenerator(opts){var count=opts.to;if(opts.to<=opts.from)while(count<=opts.from){yield count;count+=opts.by}else while(count>=opts.from){yield count;count-=opts.by}}function*countForwardGenerator(opts){var count=opts.from;if(opts.from<=opts.to)while(count<=opts.to){yield count;count+=opts.by}else while(count>=opts.to){yield count;
count-=opts.by}}function*countGenerator(opts){if(opts.reversed)yield*countReverseGenerator(opts);else yield*countForwardGenerator(opts)}function setReverseGenerator(opts,generator){if(opts.reversed)generator.reverse();return generator}function CounterGenerator(){if(!(this instanceof CounterGenerator))return new CounterGenerator;var opts={reversed:false,from:0,to:Number.MAX_SAFE_INTEGER,by:1};_.setMethod(this,"state",function(){return{reversed:opts.reversed,from:opts.from,to:opts.to,by:opts.by}});
_.setMethod(this,Symbol.iterator,function(){return countGenerator(this.state())});_.setMethod(this,"from",function(number){opts.from=_.clampToSafeIntegerRange(number);return this});_.setMethod(this,"to",function(number){opts.to=_.clampToSafeIntegerRange(number);return this});_.setMethod(this,"by",function(number){opts.by=Math.abs(_.clampToSafeIntegerRange(number));if(!opts.by)throw new TypeError("can not count by zero");return this});_.setMethod(this,"reverse",function(){opts.reversed=!opts.reversed;
return this})}_.setMethod(CounterGenerator.prototype,"map",mapGenerator);_.setMethod(CounterGenerator.prototype,"filter",filterGenerator);_.setMethod(CounterGenerator.prototype,"toArray",toArray);_.setMethod(CounterGenerator.prototype,"then",then);function*arrayGenerator(subject,opts){var generator=new CounterGenerator,key;setReverseGenerator(opts,generator.to(_.lastIndex(subject)));for(key of generator)yield getYieldValue(opts,subject,key)}function ArrayGenerator(subject){if(!(this instanceof ArrayGenerator))return new ArrayGenerator(subject);
var opts={reversed:false,entries:true,values:false,keys:false};_.setMethod(this,"state",function(){return{reversed:opts.reversed,entries:opts.entries,values:opts.values,keys:opts.keys}});_.setMethod(this,Symbol.iterator,function(){return arrayGenerator(subject,this.state())});_.setMethod(this,"entries",function(){opts.entries=true;opts.values=false;opts.keys=false;return this});_.setMethod(this,"values",function(){opts.entries=false;opts.values=true;opts.keys=false;return this});_.setMethod(this,
"keys",function(){opts.entries=false;opts.values=false;opts.keys=true;return this});_.setMethod(this,"reverse",function(){opts.reversed=!opts.reversed;return this})}_.setMethod(ArrayGenerator.prototype,"map",mapGenerator);_.setMethod(ArrayGenerator.prototype,"filter",filterGenerator);_.setMethod(ArrayGenerator.prototype,"toArray",toArray);_.setMethod(ArrayGenerator.prototype,"then",then);_.setMethod(ArrayGenerator.prototype,"unique",uniqueGenerator);_.setMethod(ArrayGenerator.prototype,"flatten",
flattenGenerator);function stringify(mapFn,thisArg){var result,item;_.mustBeFunctionIfDefined(mapFn,"mapFn");result="";for(item of this)result+=mapFn?mapFn.call(thisArg,this,item):item;return result}function getStringYieldValue(opts,character,key){var value,result;if(opts.keys)result=key;else{value=String.fromCodePoint(character.codePointAt(0));if(opts.values)result=value;else result=[key,value]}return result}function*stringGenerator(subject,opts){var generator=new CounterGenerator(opts),next=true,
char1,char2,key;setReverseGenerator(opts,generator.to(_.lastIndex(subject)));for(key of generator)if(next)if(opts.reversed){char1=subject[key-1];char2=subject[key];next=!_.isSurrogatePair(char1,char2);if(next)yield getStringYieldValue(opts,char2,key)}else{char1=subject[key];char2=subject[key+1];next=!_.isSurrogatePair(char1,char2);yield getStringYieldValue(opts,char1+char2,key)}else{next=!next;if(opts.reversed)yield getStringYieldValue(opts,char1+char2,key)}}function StringGenerator(subject){if(!(this instanceof
StringGenerator))return new StringGenerator(subject);var opts={reversed:false,entries:true,values:false,keys:false};_.setMethod(this,"state",function(){return{reversed:opts.reversed,entries:opts.entries,values:opts.values,keys:opts.keys}});_.setMethod(this,Symbol.iterator,function(){return stringGenerator(subject,this.state())});_.setMethod(this,"entries",function(){opts.entries=true;opts.values=false;opts.keys=false;return this});_.setMethod(this,"values",function(){opts.entries=false;opts.values=
true;opts.keys=false;return this});_.setMethod(this,"keys",function(){opts.entries=false;opts.values=false;opts.keys=true;return this});_.setMethod(this,"reverse",function(){opts.reversed=!opts.reversed;return this})}_.setMethod(StringGenerator.prototype,"map",mapGenerator);_.setMethod(StringGenerator.prototype,"filter",filterGenerator);_.setMethod(StringGenerator.prototype,"toArray",toArray);_.setMethod(StringGenerator.prototype,"then",then);_.setMethod(StringGenerator.prototype,"unique",uniqueGenerator);
_.setMethod(StringGenerator.prototype,"stringify",stringify);function*enumerateGenerator(subject,opts){for(var key in subject)if(!opts.own||_.hasOwn(subject,key))yield getYieldValue(opts,subject,key)}function EnumerateGenerator(subject){if(!(this instanceof EnumerateGenerator))return new EnumerateGenerator(subject);var opts={entries:true,values:false,keys:false,own:false};_.setMethod(this,"state",function(){return{entries:opts.entries,values:opts.values,keys:opts.keys,own:opts.own}});_.setMethod(this,
Symbol.iterator,function(){return enumerateGenerator(subject,this.state())});_.setMethod(this,"entries",function(){opts.entries=true;opts.values=false;opts.keys=false;return this});_.setMethod(this,"values",function(){opts.entries=false;opts.values=true;opts.keys=false;return this});_.setMethod(this,"keys",function(){opts.entries=false;opts.values=false;opts.keys=true;return this});_.setMethod(this,"own",function(){opts.own=!opts.own;return this})}_.setMethod(EnumerateGenerator.prototype,"map",mapGenerator);
_.setMethod(EnumerateGenerator.prototype,"filter",filterGenerator);_.setMethod(EnumerateGenerator.prototype,"toArray",toArray);_.setMethod(EnumerateGenerator.prototype,"then",then);_.setMethod(EnumerateGenerator.prototype,"unique",uniqueGenerator);_.setMethod(EnumerateGenerator.prototype,"flatten",flattenGenerator);_.setMethod(EnumerateGenerator.prototype,"stringify",stringify);function*mapObjectGenerator(){if(true)throw new Error("not yet");yield undefined}function*setObjectGenerator(){if(true)throw new Error("not yet");
yield undefined}function makeCounterGenerator(subject,to,by){var generator=new CounterGenerator;if(_.isNumber(subject)){if(_.isNil(to))generator.to(subject);else generator.from(subject).to(to);if(!_.isNil(by))generator.by(by)}return generator}function makeOtherGenerators(subject){var tag=_.toStringTag(subject),generator;if(tag===$.MAPTAG)generator=mapObjectGenerator(subject);else if(tag===$.SETTAG)generator=setObjectGenerator(subject);else generator=new EnumerateGenerator(subject);return generator}
function Reiterate(subject,to,by){if(!(this instanceof Reiterate))return new Reiterate(subject,to,by);var generator;if(_.isNil(subject)||_.isNumber(subject))generator=makeCounterGenerator(subject,to,by);else if(_.isArray(subject,to))generator=new ArrayGenerator(subject);else if(_.isString(subject))generator=new StringGenerator(subject);else generator=makeOtherGenerators(subject);return generator}function*iterateGenerator(relaxed){var value,tag;for(value of this)if(_.isArray(value,relaxed))yield*new ArrayGenerator(value);
else if(_.isString(value))yield*new StringGenerator(value);else{tag=_.toStringTag(value);if(tag===$.MAPTAG)yield*mapObjectGenerator(value);else if(tag===$.SETTAG)yield*setObjectGenerator(value)}}_.setMethod(mapGenerator.prototype,"filter",filterGenerator);_.setMethod(mapGenerator.prototype,"map",mapGenerator);_.setMethod(mapGenerator.prototype,"unique",uniqueGenerator);_.setMethod(mapGenerator.prototype,"iterate",iterateGenerator);_.setMethod(mapGenerator.prototype,"enumerate",EnumerateGenerator);
_.setMethod(mapGenerator.prototype,"then",then);_.setMethod(mapGenerator.prototype,"toArray",toArray);_.setMethod(mapGenerator.prototype,"flatten",flattenGenerator);_.setMethod(filterGenerator.prototype,"filter",filterGenerator);_.setMethod(filterGenerator.prototype,"map",mapGenerator);_.setMethod(filterGenerator.prototype,"unique",uniqueGenerator);_.setMethod(filterGenerator.prototype,"iterate",iterateGenerator);_.setMethod(filterGenerator.prototype,"enumerate",EnumerateGenerator);_.setMethod(filterGenerator.prototype,
"then",then);_.setMethod(filterGenerator.prototype,"toArray",toArray);_.setMethod(filterGenerator.prototype,"flatten",flattenGenerator);_.setMethod(iterateGenerator.prototype,"filter",filterGenerator);_.setMethod(iterateGenerator.prototype,"map",mapGenerator);_.setMethod(iterateGenerator.prototype,"unique",uniqueGenerator);_.setMethod(iterateGenerator.prototype,"iterate",iterateGenerator);_.setMethod(iterateGenerator.prototype,"enumerate",EnumerateGenerator);_.setMethod(iterateGenerator.prototype,
"then",then);_.setMethod(iterateGenerator.prototype,"toArray",toArray);_.setMethod(iterateGenerator.prototype,"flatten",flattenGenerator);_.setMethod(uniqueGenerator.prototype,"filter",filterGenerator);_.setMethod(uniqueGenerator.prototype,"map",mapGenerator);_.setMethod(uniqueGenerator.prototype,"unique",uniqueGenerator);_.setMethod(uniqueGenerator.prototype,"iterate",iterateGenerator);_.setMethod(uniqueGenerator.prototype,"enumerate",EnumerateGenerator);_.setMethod(uniqueGenerator.prototype,"then",
then);_.setMethod(uniqueGenerator.prototype,"toArray",toArray);_.setMethod(uniqueGenerator.prototype,"flatten",flattenGenerator);_.setMethod(flattenGenerator.prototype,"filter",filterGenerator);_.setMethod(flattenGenerator.prototype,"map",mapGenerator);_.setMethod(flattenGenerator.prototype,"unique",uniqueGenerator);_.setMethod(flattenGenerator.prototype,"iterate",iterateGenerator);_.setMethod(flattenGenerator.prototype,"enumerate",EnumerateGenerator);_.setMethod(flattenGenerator.prototype,"then",
then);_.setMethod(flattenGenerator.prototype,"toArray",toArray);_.setMethod(flattenGenerator.prototype,"flatten",flattenGenerator);return Reiterate});
